(()=>{var e={};e.id=5029,e.ids=[5029],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},65686:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>a.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>p,tree:()=>d});var r=t(50482),i=t(69108),l=t(62563),a=t.n(l),n=t(68300),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["main",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,66100)),"C:\\projects\\dooboo-client\\src\\app\\main\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,56936)),"C:\\projects\\dooboo-client\\src\\app\\main\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,21342)),"C:\\projects\\dooboo-client\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,92793)),"C:\\projects\\dooboo-client\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["C:\\projects\\dooboo-client\\src\\app\\main\\page.tsx"],x="/main/page",u={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/main/page",pathname:"/main",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},95698:(e,s,t)=>{Promise.resolve().then(t.bind(t,20826))},20826:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j});var r=t(95344),i=t(3729),l=t(8428),a=t(68258),n=t(74314),c=t.n(n),d=t(39384),o=t(10126),x=t(41964),u=t(44051);let p=function({headCss:e,battleHandler:s,refreshInventory:t}){let[l,n]=(0,i.useState)([]),[u,p]=(0,i.useState)(),[h,f]=(0,i.useState)(),[j,v]=(0,i.useState)([]),[g,w]=(0,i.useState)(!1),b=(0,i.useRef)(),y=(0,i.useRef)(null),N=e=>{e&&p(e)},q=async e=>{if(f(null),!l.map(e=>e.name).includes(e))return S(),c().fire({title:"사냥터를 선택해주세요",text:"문제가 계속되면 관리자에게 문의해주세요",icon:"error",confirmButtonText:"확인"});w(!0);let r=await (0,o.ch)(e);(r?.drops?.length||0)>0&&(t(),k()),f(r),v(r.battleLogs),r.isWin&&await s.refreshCharacterComponent()},C=e=>{b.current||(b.current=setInterval(async()=>{try{await q(e)}catch(e){S()}},5e3))},_=new Audio("/audio/item_drop.mp3"),P=new Audio("/audio/end_of_battle.mp3"),S=(0,i.useCallback)(()=>{w(!1),b.current&&(u&&b?.current&&(P.volume=.5,P.play()),clearInterval(b.current),b.current=void 0)},[u]),$=e=>{if(g)S();else{w(!0);try{C(e)}catch(e){w(!1)}}},I=(0,i.useCallback)(async()=>{let{maps:e}=await (0,o.QN)();n(e)},[]),k=()=>{_.volume=.1,_.play()},E=()=>{console.log("onAnimationEnd"),y.current?.scrollTo(0,9999999999999)};return(0,i.useEffect)(()=>(I(),()=>{S()}),[I,S]),(0,r.jsxs)(a.Card,{className:e,children:[(0,r.jsxs)("div",{className:"flex mb-5 px-[24px] pt-[20px]",children:[r.jsx("div",{className:"w-72",children:l&&l.length>0&&r.jsx(a.Select,{disabled:g,className:"rounded-r-none",label:"선택된 사냥터",value:u,onChange:e=>N(e),children:l.map(e=>r.jsx(a.Option,{value:e.name,children:e.name},(0,d.Z)()))})}),r.jsx(a.Button,{className:"rounded-l-none",color:g?"red":"indigo",size:"sm",variant:"filled",onClick:()=>$(u),children:g?"자동사냥중":"사냥하기"})]}),r.jsx("div",{className:"px-[24px] overflow-y-scroll max-h-[350px] h-[350px]",ref:y,children:h&&h.monster&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex gap-1 text-sm",children:[r.jsx("div",{children:"전투일시"}),(0,r.jsxs)("div",{children:[new Date(h.battledAt).toLocaleDateString()," ",new Date(h.battledAt).toLocaleTimeString()]})]}),(0,r.jsxs)("div",{className:"flex items-center mb-1 gap-1",children:[r.jsx("div",{children:r.jsx("img",{src:(0,x.Z)(h.monster.thumbnail),className:"max-w-[100px] rounded-lg"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center text-[20px] gap-1",children:[r.jsx("div",{className:"rounded bg-indigo-400 text-white px-4 py-0.5",children:h.monster.name}),r.jsx("div",{className:"",children:"을/를 만났습니다."})]}),(0,r.jsxs)("div",{className:"text-[12px]",children:["HP:",h.monster.hp]})]})]}),r.jsx("div",{className:"text-white text-[16px]",children:j.map((e,s)=>(0,r.jsxs)("div",{className:"animate-slideIn flex items-center mb-1 gap-1 transition text-black opacity-0",onAnimationEnd:E,style:{"--delay":`${.25*s}s`},children:[r.jsx(a.Chip,{variant:"gradient",size:"sm",className:"text-[14px] rounded px-[4px] min-w-[70px] flex items-center justify-center py-[2px]",color:e.isCriticalHit?"red":"indigo",value:`${s+1}Turn`}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[e.isCriticalHit&&r.jsx(a.Chip,{size:"sm",color:"yellow",value:"치명타!"}),r.jsx("div",{className:"bg-light-blue-300 ff-ba text-[20px] px-[6px] py-[1px] text-white rounded",children:e.damage.toFixed(2).toLocaleString()}),r.jsx("div",{children:"의 피해를 입혔습니다."})]}),(0,r.jsxs)("div",{className:"ml-auto",children:["남은 체력:",e.currentHp.toFixed(2)]})]},`battlelog-${s}`))}),(0,r.jsxs)("div",{className:"animate-slideIn transition flex flex-col opacity-0 text-[18px]",style:{"--delay":`${.25*h.battleLogs.length}s`},children:[(0,r.jsxs)("div",{className:"flex items-end mt-[10px]",children:["전투에서",r.jsx("span",{className:`pl-1 font-bold text-[20px] ${h.isWin?"text-green-900":"text-red-800"}`,children:h.isWin?"승리":"패배"}),"했습니다!"]}),h.isWin&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex gap-1",children:[r.jsx(a.Chip,{color:"teal",variant:"gradient",size:"sm",value:`+${h.monster.experience} exp`}),r.jsx(a.Chip,{color:"yellow",variant:"gradient",size:"sm",value:`+${h.monster.gold} Gold`})]}),h.drops.length>0&&r.jsx(m,{drops:h.drops})]})]})]})})]})};function m({drops:e}){return(0,r.jsxs)("div",{className:"flex flex-col gap-1 mt-10",children:[r.jsx("div",{className:"bg-indigo-400 text-white text-[20px] pl-1",children:"획득한 아이템"}),r.jsx("div",{className:"flex flex-row gap-1",children:e.map(e=>r.jsx(u.We,{item:e,className:"border p-[2px]"},`drops_${e._id}`))})]})}var h=t(9770);let f=function({user:e,character:s,nextExp:t,stat:i,equippedItems:l,refreshInventory:n,refreshMe:c}){let d=async e=>{await (0,o.uw)(e._id),await Promise.all([n(),c()])};return r.jsx(a.Card,{className:"rounded min-w-[460px] w-full flex flex-col justify-start items-start min-h-40",children:r.jsx(a.CardBody,{className:"w-full",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex gap-1",children:[r.jsx("div",{className:"w-[80px] h-[80px] min-w-[80px] min-h-[80px] border border-gray-600 rounded p-[1px] flex items-center justify-center",children:r.jsx("img",{className:"w-full",src:h.LJ})}),(0,r.jsxs)("div",{className:"w-full flex flex-col gap-[2px]",children:[(0,r.jsxs)("div",{className:"flex w-full justify-between",children:[(0,r.jsxs)("div",{children:["Lv.",s.level]}),r.jsx("div",{children:e.nickname})]}),(0,r.jsxs)("div",{className:"w-full flex justify-between",children:[r.jsx("div",{children:"골드"}),r.jsx("div",{children:s.gold.toLocaleString()})]}),(0,r.jsxs)("div",{className:"w-full flex justify-between items-center",children:[r.jsx("div",{children:"경험치"}),r.jsx("div",{children:r.jsx(a.Tooltip,{interactive:!0,content:`경험치 ${s.experience} / ${t}`,children:(0,r.jsxs)("div",{className:"min-w-[250px] max-w-[250px] min-h-[26px] flex justify-center items-center relative rounded-md overflow-hidden border-2 border-blue-200 noselect cursor-pointer",children:[r.jsx("div",{className:"absolute left-0 max-w-[300px] min-h-full opacity-80 z-20",style:{width:`${s.experience/t*250}px`,background:"linear-gradient(90deg, rgba(2,0,36,1) 0%, rgba(9,9,121,1) 35%, rgba(0,212,255,1) 100%)",transition:"width 1s"}}),r.jsx("div",{className:"absolute min-w-[250px] max-w-[{EXP_WIDTH$px] min-h-full bg-blue-100"}),(0,r.jsxs)("div",{className:"z-20 absolute min-w-[250px] max-w-[{EXP_WIDTH$px] min-h-full flex items-center justify-center text-white ff-ba text-[20px] leading-[20px]",children:[(s.experience/t*100).toFixed(2),"%"]})]})})})]})]})]}),(0,r.jsxs)("div",{className:"w-full flex justify-between",children:[r.jsx("div",{children:"물리 피해"}),r.jsx("div",{children:i.damageOfPhysical})]}),(0,r.jsxs)("div",{className:"w-full flex justify-between",children:[r.jsx("div",{children:"화염 피해"}),r.jsx("div",{children:i.damageOfFire})]}),(0,r.jsxs)("div",{className:"w-full flex justify-between",children:[r.jsx("div",{children:"냉기 피해"}),r.jsx("div",{children:i.damageOfCold})]}),(0,r.jsxs)("div",{className:"w-full flex justify-between",children:[r.jsx("div",{children:"번개 피해"}),r.jsx("div",{children:i.damageOfLightning})]}),(0,r.jsxs)("div",{className:"w-full flex justify-between",children:[r.jsx("div",{children:"치명타 확률"}),(0,r.jsxs)("div",{children:[i.criticalRate.toFixed(2),"%"]})]}),(0,r.jsxs)("div",{className:"w-full flex justify-between",children:[r.jsx("div",{children:"치명타 배율"}),(0,r.jsxs)("div",{children:["+",i.criticalMultiplier,"%"]})]}),r.jsx("hr",{className:"mb-1"}),(0,r.jsxs)("div",{children:[r.jsx("div",{children:"착용장비"}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[l?.length===0&&r.jsx("div",{className:"w-full min-h-[30px] border border-gray-300 rounded flex justify-center items-center",children:"착용된 장비가 없습니다."}),l?.length>0&&l.map(e=>(0,r.jsxs)("div",{className:"flex gap-1",children:[r.jsx("div",{className:"min-w-[30px] min-h-[30px] border border-gray-300 rounded flex justify-center items-center bg-red-300 text-white cursor-pointer",onClick:()=>d(e),children:"x"}),r.jsx(a.Tooltip,{className:"rounded-none bg-transparent",interactive:!0,content:r.jsx(u.VQ,{item:e,actions:[u.jD.Share]}),children:(0,r.jsxs)("div",{className:"pl-[3px] w-full min-h-[30px] border border-gray-300 rounded flex justify-start items-center gap-1",children:[r.jsx("img",{src:(0,x.Z)(e.weapon.thumbnail),className:"w-[24px] h-[24px] border rounded"}),r.jsx("div",{children:e.weapon.name})]})})]},`${e._id}_equipped`))]})]})]})})})};function j(){let e=(0,l.useRouter)(),[s,t]=(0,i.useState)(null),[a,n]=(0,i.useState)(null),[c,d]=(0,i.useState)(0),[x,m]=(0,i.useState)(),[h,j]=(0,i.useState)([]),v=(0,i.useRef)(null),g=async()=>{try{let{nextExp:e,user:s,character:r,stat:i,equippedItems:l}=await (0,o.aM)();localStorage.setItem("characterId",r._id),t(s),n(r),d(e),m(i),j(l)}catch(r){let{response:s}=r||{},{data:t}=s||{};if(t?.message==="NotFoundCharacter"){let s=localStorage.getItem("token");e.push(`/register?accessToken=${s}`)}}},w=()=>{v?.current?.refresh()};return(0,i.useEffect)(()=>{g()},[]),r.jsx("div",{className:"w-full",children:(0,r.jsxs)("div",{className:"items-center flex flex-col w-full",children:[r.jsx("div",{className:"w-full min-h-80 grid grid-cols-8 justify-center items-center mb-2",children:s&&r.jsx(p,{headCss:"col-span-8 h-full rounded w-full",battleHandler:{refreshCharacterComponent:async()=>{await g()}},refreshInventory:w})}),(0,r.jsxs)("div",{className:"justify-between w-full flex gap-1",children:[s&&r.jsx(f,{character:a,user:s,nextExp:c,stat:x,equippedItems:h,refreshInventory:w,refreshMe:g}),s&&r.jsx(u.ZP,{ref:v,refreshInventory:w,refreshMe:g,equippedItems:h})]})]})})}},66100:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>i,default:()=>a});let r=(0,t(86843).createProxy)(String.raw`C:\projects\dooboo-client\src\app\main\page.tsx`),{__esModule:i,$$typeof:l}=r,a=r.default}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[1638,8356,9404,8258,8389,7030,1067,9603,5282],()=>t(65686));module.exports=r})();