(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6160],{22007:function(e,s,i){Promise.resolve().then(i.bind(i,5800))},5800:function(e,s,i){"use strict";i.r(s),i.d(s,{default:function(){return o}});var d=i(57437),a=i(10243),l=i(2265),r=i(63411),n=i.n(r),t=i(605),c=i(40874),x=i(26874),h=i(43951),p=(0,l.forwardRef)(function(e,s){let{result:i}=e,[r,n]=(0,l.useState)(!1),t=async()=>{n(!0)};return(0,l.useImperativeHandle)(s,()=>({open:()=>{t()}})),(0,d.jsx)(a.Dialog,{open:r,handler:()=>{n(!r)},className:"min-w-[600px!important]",children:(0,d.jsxs)(a.DialogBody,{className:"min-h-[250px] overflow-y-scroll flex justify-center items-center",children:[!i&&(0,d.jsx)("div",{className:"text-[50px] text-red-500",children:"강화 실패!"}),i&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-[30px] text-green-700 flex justify-center mb-[10px]",children:"강화 성공!"}),(0,d.jsxs)("div",{className:"flex gap-[10px] items-center",children:[(0,d.jsxs)("div",{className:"border border-gray-800 p-[10px] rounded w-[250px]",children:[(0,d.jsx)("div",{className:"flex justify-center",children:"강화 전"}),(0,d.jsx)("div",{className:"border-b border-b-dark-blue mb-[4px]"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"flex gap-[1px] justify-center",children:Array(i.enhancedLog.snapshot.maxStarForce).fill(1).map((e,s)=>{let a=s<i.enhancedLog.snapshot.starForce;return(0,d.jsx)("img",{className:"w-[16px] h-[16px]",src:"/images/star_".concat(a?"on":"off",".png")},(0,c.Z)())})}),(0,d.jsx)("div",{className:"flex justify-center",children:(0,d.jsx)("img",{className:"w-[40px] h-[40px]",src:(0,h.Z)(i.enhancedLog.snapshot.thumbnail)})}),(0,d.jsx)("div",{className:"flex justify-center",children:i.enhancedLog.snapshot.name}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"물리 피해"}),(0,d.jsx)("div",{children:i.enhancedLog.snapshot.damageOfPhysical})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"화염 피해"}),(0,d.jsx)("div",{children:i.enhancedLog.snapshot.damageOfFire})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"번개 피해"}),(0,d.jsx)("div",{children:i.enhancedLog.snapshot.damageOfLightning})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"냉기 피해"}),(0,d.jsx)("div",{children:i.enhancedLog.snapshot.damageOfCold})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"치명타 확률"}),(0,d.jsxs)("div",{children:["+",i.enhancedLog.snapshot.criticalRate,"%"]})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"치명타 배율"}),(0,d.jsxs)("div",{children:["+",i.enhancedLog.snapshot.criticalMultiplier,"%"]})]})]})]}),(0,d.jsx)("div",{children:"->"}),(0,d.jsxs)("div",{className:"border border-gray-800 p-[10px] rounded  w-[250px]",children:[(0,d.jsx)("div",{className:"flex justify-center",children:"강화 후"}),(0,d.jsx)("div",{className:"border-b border-b-dark-blue mb-[4px]"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"flex gap-[1px] justify-center",children:Array(i.updatedWeapon.maxStarForce).fill(1).map((e,s)=>{let a=s<i.updatedWeapon.starForce;return(0,d.jsx)("img",{className:"w-[16px] h-[16px]",src:"/images/star_".concat(a?"on":"off",".png")},(0,c.Z)())})}),(0,d.jsx)("div",{className:"flex justify-center",children:(0,d.jsx)("img",{className:"w-[40px] h-[40px]",src:(0,h.Z)(i.updatedWeapon.thumbnail)})}),(0,d.jsx)("div",{className:"flex justify-center",children:i.updatedWeapon.name}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"물리 피해"}),(0,d.jsx)("div",{children:i.updatedWeapon.damageOfPhysical})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"화염 피해"}),(0,d.jsx)("div",{children:i.updatedWeapon.damageOfFire})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"번개 피해"}),(0,d.jsx)("div",{children:i.updatedWeapon.damageOfLightning})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"냉기 피해"}),(0,d.jsx)("div",{children:i.updatedWeapon.damageOfCold})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"치명타 확률"}),(0,d.jsxs)("div",{children:["+",i.updatedWeapon.criticalRate,"%"]})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("div",{children:"치명타 배율"}),(0,d.jsxs)("div",{children:["+",i.updatedWeapon.criticalMultiplier,"%"]})]})]})]})]})]})]})})});function o(){let e=(0,l.useRef)(),[s,i]=(0,l.useState)([]),[r,h]=(0,l.useState)(0),[o,j]=(0,l.useState)(0),[m,f]=(0,l.useState)(),[u,v]=(0,l.useState)([]),[g,N]=(0,l.useState)(),[b,y]=(0,l.useState)(),w=async()=>{let{items:e,slots:s,isFulled:d,gold:a}=await (0,t.iX)();j(a),i(e),h(s),f(d)},S=async()=>{if(4!==u.filter(e=>!!e).length){await n().fire({title:"강화 재료를 모두 선택하세요",text:"-",icon:"error",denyButtonText:"닫기"});return}let{isConfirmed:s}=await n().fire({title:"정말로 강화하시겠습니까?",text:"-",icon:"question",confirmButtonText:"예",denyButtonText:"닫기",showDenyButton:!0});if(s){var i;let s=await (0,t.AS)(u[0]._id,{itemIds:[u[1]._id,u[2]._id,u[3]._id]});await L(),s.isSuccess?y(s):y(void 0),null===(i=e.current)||void 0===i||i.open()}},_=async e=>{let d=s.filter(e=>e.isSelected);if(4<=d.length&&!d.find(s=>s._id===e._id))return;let a=s.findIndex(s=>s._id===e._id);if(a<0)return;i(s.map((e,s)=>{if(a===s){let s={...e};return s.isSelected=!s.isSelected,s}return e}));let l=u.findIndex(e=>(null==e?void 0:e._id)===s[a]._id);if(l<0){let e=u.findIndex(e=>!e);if(e<0)v([...u,{...s[a]}]);else{let i=[...u];return i[e]={...s[a]},v(i)}}else{let e=[...u];e[l]=void 0,v(e)}},W=async()=>{if(N(void 0),!u[0])return;let e=await (0,t.YK)(u[0]._id);u[0]&&N(e)},L=async()=>{await w(),v([]),N(void 0)};return(0,l.useEffect)(()=>{(null==u?void 0:u.length)<=0||W()},[u]),(0,l.useEffect)(()=>{L()},[]),(0,d.jsxs)("div",{children:[(0,d.jsx)(p,{ref:e,result:b}),(0,d.jsxs)(a.Card,{className:"rounded p-[8px]",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("img",{src:"/images/icon_currency.png",className:"w-[30px]"}),(0,d.jsx)("div",{children:o.toLocaleString()})]}),(0,d.jsxs)("div",{className:"flex items-stretch gap-[10px]",children:[(0,d.jsxs)("div",{className:"grow basis-1 border flex flex-col gap-[2px] p-[8px] justify-center",children:[(0,d.jsx)("div",{className:"w-full text-[16px] flex justify-center mb-[20px]",children:"오른쪽의 인벤토리에서 강화할 아이템과 재료 아이템을 선택하세요"}),(0,d.jsxs)("div",{className:"flex items-center justify-center gap-[2px]",children:[(0,d.jsx)("div",{children:"원본"}),(0,d.jsx)("div",{className:"bg-white relative flex border-[1px] border-r rounded-md w-[40px] h-[40px] items-center justify-center flex",children:u[0]&&(0,d.jsx)(x.We,{className:"p-[2px]",item:u[0],onShowTotalDamage:!0,equippedCallback:()=>{}})})]}),(0,d.jsxs)("div",{className:"flex items-center justify-center gap-[2px]",children:[(0,d.jsx)("div",{children:"재료"}),(0,d.jsx)("div",{className:"bg-white relative flex border-[1px] border-r rounded-md w-[40px] h-[40px] items-center justify-center flex",children:u[1]&&(0,d.jsx)(x.We,{className:"p-[2px]",item:u[1],onShowTotalDamage:!0,equippedCallback:()=>{}})}),(0,d.jsx)("div",{className:"bg-white relative flex border-[1px] border-r rounded-md w-[40px] h-[40px] items-center justify-center flex",children:u[2]&&(0,d.jsx)(x.We,{className:"p-[2px]",item:u[2],onShowTotalDamage:!0,equippedCallback:()=>{}})}),(0,d.jsx)("div",{className:"bg-white relative flex border-[1px] border-r rounded-md w-[40px] h-[40px] items-center justify-center flex",children:u[3]&&(0,d.jsx)(x.We,{className:"p-[2px]",item:u[3],onShowTotalDamage:!0,equippedCallback:()=>{}})})]}),(0,d.jsx)("div",{className:"flex justify-center items-center w-full border rounded",children:(0,d.jsxs)("div",{className:"text-[20px] min-h-[30px] flex justify-center items-center",children:[g&&(0,d.jsxs)("div",{className:"flex items-center gap-[2px]",children:[(0,d.jsxs)("div",{className:"text-green-400",children:["성공률: ",g.successRate,"%"]}),(0,d.jsxs)("div",{className:"flex items-center text-amber-600",children:[(0,d.jsx)("div",{children:g.price.toLocaleString()}),(0,d.jsx)("img",{src:"/images/icon_currency.png",className:"w-[30px]"})]})]}),!g&&(0,d.jsx)("div",{children:"알수없음"})]})}),(0,d.jsx)("div",{className:"flex justify-center",children:(0,d.jsx)("div",{className:"text-[24px] bg-green-500 text-white px-[6px] py-[4px] rounded cursor-pointer",onClick:()=>S(),children:"강화하기"})}),(0,d.jsxs)("div",{className:"flex flex-col gap-[2px] text-[16px] mt-[20px]",children:[(0,d.jsx)("div",{className:"text-[20px]",children:"강화"}),(0,d.jsx)("div",{children:"재료 아이템 3개를 소모하여, 원본 아이템을 강화합니다."}),(0,d.jsx)("div",{children:"원본과 재료는 동일한 아이템 이어야하며, 소모된 아이템은 삭제됩니다."}),(0,d.jsx)("div",{children:"강화 성공 확률은 현재 강화레벨에 따라 변동됩니다."}),(0,d.jsx)("div",{children:"강화 성공 시, 아이템의 [1 ~ (총 물리+화염+냉기+번개 데미지)의 10% ] 값이 랜덤한 데미지로 추가 됩니다."})]})]}),(0,d.jsx)("div",{className:"grow basis-1 border flex justify-center",children:(0,d.jsxs)("div",{className:"flex  flex-col",children:[(0,d.jsx)("div",{children:"인벤토리"}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)("div",{children:(0,d.jsx)("div",{className:"flex flex-wrap max-w-[414px] bg-gray-100 p-[2px] rounded shadow-md gap-[1px]",children:Array(100).fill(1).map((e,i)=>{let a=s[i],l=i>=r;return(0,d.jsxs)("div",{className:"bg-white relative flex border-[1px] border-r rounded-md w-[40px] h-[40px] ".concat(l?"bg-gray-800":""," ").concat((null==a?void 0:a.isSelected)?"border-red-300":""),children:[l&&(0,d.jsx)("div",{className:"absolute z-10 bg-gray-800 bg-opacity-60 w-[40px] h-[40px] rounded"}),a&&(0,d.jsx)(x.We,{className:"p-[2px]",item:a,onShowTotalDamage:!0,equippedCallback:()=>{},onSelect:_})]},(0,c.Z)())})})})})]})})]})]})]})}}},function(e){e.O(0,[6384,9461,6990,1866,8694,7908,7187,7391,6874,2971,8069,1744],function(){return e(e.s=22007)}),_N_E=e.O()}]);